{"version":3,"sources":["config.js","app-src.js","controllers/errorCtrl.js","controllers/filesCtrl.js","controllers/homeCtrl.js","directives/popup.js","directives/preview.js","directives/resizeableImage.js","directives/tagsEditor.js","directives/tagsTextBox.js","services/FileService.js","services/TagService.js"],"names":["config","theme","viewsPath","max_title_length","apiPath","angular","module","$stateProvider","$urlRouterProvider","$locationProvider","html5Mode","hashPrefix","otherwise","state","url","templateUrl","controller","$scope","layout","run","$state","window","console","log","info","warn","error","$stateParams","errorNumber","$args","$location","FileService","TagService","generatePath","p","path","split","i","push","label","InitialList","getList","then","data","list","slice","Search","SearchTags","typingTimer","typingTimeout","Fetch","text","this","setTimeout","searchTags","searchArr","length","indexOf","search","Preview","IsVisible","Open","index","item","selection","ToggleCheck","Index","Visible","SelectedItems","Array","e","selected","splice","stopPropagation","FolderClick","btSelection","test","TestVisible","directive","restrict","transclude","scope","visible","top","left","width","height","link","$elem","$attrs","CloseClick","ImageZIndex","Minimized","Top","Left","Width","Height","Maximized","WindowState","$watch","type","ImageClick","Next","Prev","OpenExternal","w","open","focus","ToggleTags","TagsVisible","ToggleFullScreen","isMax","target","innerHTML","$window","source","resize","img","style","contentWidth","contentDiv","offsetWidth","contentHeight","offsetHeight","ratio","oWidth","oHeight","alignCenter","parent","element","bind","attr","src","tImg","Image","onload","Selecected","forEach","db_tags","tag","key","tag_name","Save","saveOne","getFileTags","updatedTags","selectedTags","onchanged","ontype","elem","attrs","suggestions","selectedIndex","removeTag","onChangeEvent","searchText","tags","value","name","unshift","onTypeEvent","addToSelectedTags","isNaN","checkKeyDown","event","keyCode","preventDefault","val","onchangeHandler","isFunction","ontypeHandler","functionToCheck","getType","toString","call","factory","$http","$path","get","cache","result","addData","$tags","post","thumbnail","full","preview","title","substring","$text"],"mappings":"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","file":"app.js","sourcesContent":["var config = {\n\t\ttheme: 'standard',\n\t    viewsPath: 'app/views',\n\t\tmax_title_length: 20,\n\t    apiPath: 'http://dev.home.il/mgallery/api'\n};\n\n","angular\n\t.module('mgallery', ['ui.router', 'controllers', 'services', 'directives'])\n\t.config(['$stateProvider', '$urlRouterProvider', '$locationProvider', function($stateProvider, $urlRouterProvider, $locationProvider) {\n\t\t\n\t\t$locationProvider.html5Mode(true).hashPrefix('!');\n\t    $urlRouterProvider.otherwise('/error/404');\n\t    \n\t    $stateProvider\n\t\t.state('home', {\n\t\t\turl: '/',\n\t\t\ttemplateUrl: config.viewsPath + '/home.tmpl.html'\n\t    })\n\n\t\t.state('filesMain', {\n\t\t\turl: '/files',\n\t\t\ttemplateUrl: config.viewsPath + '/files.tmpl.html'\n\t\t})\n\n\t    .state('filesMain2', {\n\t\t\turl: '/files/',\n\t\t\ttemplateUrl: config.viewsPath + '/files.tmpl.html'\n\t    })\n\n\t\t.state('files', {\n\t\t\turl: '/files/{path:.+}',\n\t\t\ttemplateUrl: config.viewsPath + '/files.tmpl.html'\n\t\t})\n\n\t    .state('404', {\n\t    \turl: '/error/:errorNumber',\n\t    \ttemplateUrl: config.viewsPath + '/error.tmpl.html',\n\t    \tcontroller: 'errorCtrl'\n\t    });\n\t    \n\t}])\n\t\n\t.controller('AppCtrl', ['$scope', function ($scope){\n\t\t$scope.layout = 'app/themes/'+config.theme+'/_layout.html';\n\t}])\n\t\n\t.run(['$state', function($state){}]);\n\nangular.module('controllers', []);\nangular.module('services', []);\nangular.module('directives', []);\n\nif(!window.console){ window.console = {log: function(){}, info: function(){}, warn: function(){}, error: function(){} }; }","angular\n\t.module('controllers')\n\t.controller('errorCtrl', ['$scope', '$stateParams', function($scope, $stateParams) {\n\t\t\n\t\t$scope.error = $stateParams.errorNumber;\n\t\t\n\t}]);","angular\n\t.module('controllers')\n\t.controller('filesCtrl', ['$scope', '$stateParams', '$location', 'FileService', 'TagService', function($scope, $args, $location, FileService, TagService) {\n\n        generatePath();\n\n        $scope.InitialList = null;\n\n        FileService.getList($args.path).then(function(data) {\n            $scope.InitialList = data;\n            $scope.list = $scope.InitialList.slice();\n        });\n\n\n        $scope.Search = {\n            SearchTags: [],\n            typingTimer: null,\n            typingTimeout: 400,\n            Fetch: function(text) {\n                this.typingTimer = setTimeout(function() {\n                    var searchTags = $scope.Search.SearchTags;\n                    var searchArr = searchTags.slice();\n\n                    if(text && text.length > 3 && searchArr.indexOf(text) === -1)\n                        searchArr.push(text);\n\n                    if(searchArr.length == 0) {\n                        $scope.list = $scope.InitialList.slice();\n                        return;\n                    }\n\n                    FileService.search(searchArr).then(function(data) {\n                        $scope.list = data;\n                    });\n\n                }, this.typingTimeout);\n            }\n        };\n\n\n\n        $scope.Preview = {\n            IsVisible: false,\n            Open: function(index) {\n                var item = $scope.list[index];\n                if($scope.selection)\n                    return $scope.ToggleCheck(item);\n\n                $scope.Preview.Index = index;\n                $scope.Preview.Visible = true;\n            }\n        };\n\n\n        $scope.SelectedItems = new Array();\n\n\n\n\n\n\n\n        $scope.ToggleCheck = function(item, e) {\n            item.selected = !item.selected;\n\n\n\n            if(item.selected)\n                $scope.SelectedItems.push(item);\n            else\n                $scope.SelectedItems.splice($scope.SelectedItems.indexOf(item), 1);\n\n            if(e)\n                e.stopPropagation();\n        };\n\n\n        $scope.FolderClick = function(path){\n            $location.path('/files/' + path);\n        };\n\n\n\n        $scope.btSelection = function() {\n            $scope.selection = !$scope.selection;\n        };\n\n        function generatePath() {\n            var p = ($args.path) ? $args.path.split('/') : [];\n            $scope.path = [];\n            var url = \"\";\n            for(var i in p){\n                url+= (i > 0) ? \"/\"+p[i] : p[i];\n                $scope.path.push({\n                    label: p[i],\n                    url: url\n                });\n            }\n        }\n\t}]);\n\n\t\t\n","angular\n\t.module('controllers')\n\t.controller('homeCtrl', ['$scope', '$stateParams', function($scope, $args) {\n\n        $scope.test = new Array();\n        $scope.TestVisible = true;\n\t}]);\n\n\t\t\n","angular.module('directives')\n    .directive('popup',[function() {\n        return {\n            restrict:'AE',\n            transclude: true,\n            scope:{\n                visible:'=visible',\n                top: '=top',\n                left: '=left',\n                width: '=width',\n                height: '=height'\n            },\n            templateUrl: config.viewsPath + '/cmp/popup.tmpl.html',\n            link:function($scope,$elem,$attrs) {\n\n                $scope.CloseClick = function() {\n                    $scope.visible = false;\n                };\n\n\n            }\n        }\n    }]);\n","angular.module('directives')\n    .directive('preview',[function() {\n        return {\n            restrict:'AE',\n            scope:{\n                list:'=list',\n                index: '=index',\n                visible: '=visible'\n            },\n            templateUrl: config.viewsPath + '/cmp/preview.tmpl.html',\n            link:function($scope,$elem,$attrs) {\n                $scope.visible = false;\n                $scope.item = null;\n                $scope.ImageZIndex = \"10\";\n\n                var Minimized = {\n                    Top: \"20%\",\n                    Left: \"25%\",\n                    Width: \"50%\",\n                    Height: \"60%\"\n                };\n\n                var Maximized = {\n                    Top: \"0\",\n                    Left: \"0\",\n                    Width: \"100%\",\n                    Height: \"100%\"\n                };\n\n                $scope.WindowState = Minimized;\n\n\n                $scope.$watch(\"index\", function(index) {\n                    if(index < 0 || !$scope.list || $scope.list.length == 0 || index > $scope.list.length || !$scope.list[index] || $scope.list[index].type == \"folder\")\n                        return;\n\n                    $scope.item = $scope.list[index];\n                });\n\n                $scope.ImageClick = function() {\n                    $scope.ImageZIndex = ($scope.ImageZIndex == \"10\") ? \"30\" : \"10\";\n                };\n\n                $scope.Next = function()  {\n                    $scope.index++;\n                };\n\n                $scope.Prev = function() {\n                    $scope.index--;\n                };\n\n                $scope.OpenExternal = function (url) {\n                    var w=window.open(url,'_blank');\n                    w.focus();\n                };\n\n                $scope.ToggleTags = function() {\n                    $scope.TagsVisible = !$scope.TagsVisible;\n                };\n\n                $scope.ToggleFullScreen = function(e) {\n                    var isMax = (e.target.innerHTML == \"Maximize\");\n                    $scope.WindowState = isMax ? Maximized : Minimized;\n                    e.target.innerHTML = isMax ? \"Minimize\" : \"Maximize\";\n                };\n            }\n        }\n    }]);","angular.module('directives')\n    .directive('resizeableImage',['$window', function($window) {\n        return {\n            scope: {\n                source: \"=source\"\n            },\n            link:function($scope,$elem,$attrs) {\n\n                var contentDiv = $elem.parent().parent().parent().parent();\n                var contentWidth, contentHeight;\n                var img = $elem[0];\n                var oWidth, oHeight;\n\n\n                angular.element($window).bind(\"resize\", resize);\n\n\n                $scope.$watch(function() {return contentDiv.attr('style'); }, resize);\n                $scope.$watch(function() {return $elem.attr('style'); }, resize);\n\n\n                $scope.$watch(\"source\", function(src) {\n                    var tImg = new Image();\n                    tImg.onload =  function() {\n                        oWidth = this.width;\n                        oHeight = this.height;\n                        img.src = this.src;\n                        img.width = oWidth;\n                        img.height = oHeight;\n                        resize();\n                    };\n                    tImg.src = src;\n                });\n\n                function resize() {\n\n                    img.style.left =0;\n                    img.style.top = 0;\n\n                    contentWidth = contentDiv[0].offsetWidth-4;\n                    contentHeight = contentDiv[0].offsetHeight-4;\n                    if(contentWidth < 1)\n                        return;\n\n                    var ratio = oWidth / oHeight;\n\n                    if(oWidth - contentWidth > oHeight - contentHeight)\n                    {\n                        img.width = contentWidth;\n                        img.height = img.width / ratio;\n                    }\n                    else {\n                        img.height = contentHeight;\n                        img.width = img.height * ratio;\n                    }\n\n                    alignCenter();\n                }\n\n                function alignCenter()\n                {\n                    if(contentWidth - img.width > 0)\n                        img.style.left = (contentWidth-img.width) /2 + \"px\";\n\n                    if(contentHeight - img.height > 0)\n                        img.style.top = (contentHeight-img.height) /2 + \"px\";\n                }\n\n\n\n\n            }\n        }\n    }]);","angular.module('directives')\n    .directive('tagsEditor',['TagService', function(TagService) {\n        return {\n            restrict:'AE',\n            scope:{\n                visible: \"=visible\",\n                item: \"=item\"\n            },\n            templateUrl: config.viewsPath + '/cmp/tags-editor.tmpl.html',\n            link:function($scope,$elem,$attrs) {\n                $scope.Selecected = [];\n\n                $scope.$watch(\"item\", function(item) {\n                    if(!item)\n                        return;\n\n                    $scope.Selecected.length = 0;\n\n                    angular.forEach(item.db_tags, function(tag, key) {\n                        if($scope.Selecected.indexOf(tag.tag_name) < 0)\n                           $scope.Selecected.push(tag.tag_name);\n                    });\n                });\n\n\n                $scope.Save = function() {\n                    TagService.saveOne($scope.item.path, $scope.Selecected).then(function(data) {\n                        //update\n                        TagService.getFileTags($scope.item.path).then(function(updatedTags) {\n                            $scope.item.db_tags = updatedTags;\n                        });\n                    });\n                };\n\n\n\n            }\n        }\n    }]);","angular.module('directives')\n    .directive('tagsTextBox',['TagService',function(TagService) {\n        return {\n            restrict:'AE',\n            scope:{\n                selectedTags:'=model',\n                onchanged: '&onchanged',\n                ontype: '&ontype'\n            },\n            templateUrl: config.viewsPath + '/cmp/tags-text-box.tmpl.html',\n            link:function(scope,elem,attrs) {\n\n                scope.suggestions = [];\n\n                if (!scope.selectedTags)\n                    scope.selectedTags = [];\n\n                scope.selectedIndex = -1;\n\n                scope.removeTag = function (index) {\n                    scope.selectedTags.splice(index, 1);\n                    onChangeEvent();\n                };\n\n                scope.search = function () {\n                    TagService.search(scope.searchText).then(function (data) {\n                        var tags = new Array();\n                        angular.forEach(data, function (value, key) {\n                            tags.push(value.name);\n                        });\n\n\n                        if (tags.indexOf(scope.searchText) === -1) {\n                            tags.unshift(scope.searchText);\n                        }\n                        scope.suggestions = tags;\n                        scope.selectedIndex = -1;\n\n                        onTypeEvent(scope.searchText);\n                    });\n                };\n\n                scope.addToSelectedTags = function (index) {\n                    var tag = \"\";\n                    if(!isNaN(index) && index > -1)\n                        tag = scope.suggestions[index];\n                    else\n                        tag = scope.searchText;\n\n                    if (scope.selectedTags.indexOf(tag) === -1) {\n                        scope.selectedTags.push(tag);\n                        scope.searchText = '';\n                        scope.suggestions = [];\n\n                        onChangeEvent();\n                    }\n\n                };\n\n                scope.checkKeyDown = function (event) {\n                    if (event.keyCode === 40) {\n                        event.preventDefault();\n                        if (scope.selectedIndex + 1 !== scope.suggestions.length) {\n                            scope.selectedIndex++;\n                        }\n                    }\n                    else if (event.keyCode === 38) {\n                        event.preventDefault();\n                        if (scope.selectedIndex - 1 !== -1) {\n                            scope.selectedIndex--;\n                        }\n                    }\n                    else if (event.keyCode === 13) {\n                        scope.addToSelectedTags(scope.selectedIndex);\n                    }\n                };\n\n                scope.$watch('selectedIndex', function (val) {\n                    if (val !== -1) {\n                        scope.searchText = scope.suggestions[scope.selectedIndex];\n                    }\n                });\n\n                onChangeEvent = function () {\n                    if(!scope.onchanged)\n                        return;\n\n                    var onchangeHandler = scope.onchanged();\n\n                    if(isFunction(onchangeHandler)) {\n                        onchangeHandler();\n                    }\n                };\n\n                onTypeEvent = function(text) {\n                    if(!scope.ontype)\n                        return;\n\n                    var ontypeHandler = scope.ontype();\n                    if(isFunction(ontypeHandler))\n                        ontypeHandler(text);\n                };\n\n                isFunction = function(functionToCheck) {\n                    var getType = {};\n                    return functionToCheck && getType.toString.call(functionToCheck) === '[object Function]';\n                };\n\n            }\n        }\n    }]);\n","angular\n\t.module('services')\n\t.factory('FileService', ['$http', function($http){\n\n\t\treturn {\n\t\t\t// Return public API.\n\t\t\tgetList: getList,\n            search: search\n\t\t};\n\t\t\n\t\t\n\t\t// ---\n\t\t// PUBLIC METHODS.\n\t\t// ---\n\t\tfunction getList($path) {\n\t\t\t$path = ($path) ? $path : '';\n\t\t\treturn $http.get(config.apiPath+ '/list/'+$path, { cache: true}).then(function(result) {\n\t\t\t\treturn addData(result.data);\n\t\t\t});\t\n\t\t}\n\n        function search($tags) {\n            return $http.post(config.apiPath+ '/search', $tags).then(function(result) {\n                return addData(result.data);\n            });\n        }\n\n        function addData(list) {\n            angular.forEach(list, function(value, key) {\n                if(value.type != 'folder') {\n                    value.thumbnail = config.apiPath + '/thumb/256/' + value.path;\n                    value.full = config.apiPath + '/thumb/full/' + value.path;\n                    value.preview = config.apiPath + '/thumb/700/' + value.path;\n                }\n                value.title = (value.name.length < config.max_title_length) ? value.name : value.name.substring(0, config.max_title_length) + '...';\n            });\n            return list;\n        }\n}]);\n\n//http://www.bennadel.com/blog/2612-using-the-http-service-in-angularjs-to-make-ajax-requests.htm","angular\n    .module('services')\n    .factory('TagService', ['$http', function($http){\n\n\n        return {\n            // Return public API.\n            saveOne: saveOne,\n            getFileTags: getFileTags,\n            search: search\n        };\n\n\n        // ---\n        // PUBLIC METHODS.\n        // ---\n        function saveOne($path, $tags) {\n            return $http.post(config.apiPath+ '/tag/one/'+$path, $tags ).then(function(result) {\n                return result.data;\n            });\n        }\n\n        function getFileTags($path) {\n            return $http.get(config.apiPath+ '/tag/one/'+$path, {cache: false}).then(function(result) {\n                return result.data;\n            });\n        }\n\n        function search($text) {\n            if($text && $text.length > 1) {\n                return $http.get(config.apiPath + '/tag/search/' + $text, {cache: false}).then(function (result) {\n                    return result.data;\n                });\n            }\n            else\n            {\n                return { then: function() {return new Array(); }};\n            }\n        }\n\n    }]);\n\n//http://www.bennadel.com/blog/2612-using-the-http-service-in-angularjs-to-make-ajax-requests.htm"],"sourceRoot":"/source/"}